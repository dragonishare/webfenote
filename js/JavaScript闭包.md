# JavaScript闭包（closure）
## 概念/定义

* **==闭包==是指有权访问另一个函数作用域中的变量的函数。** 【JavaScript高级程序设计（3rd）】

> 创建闭包的常见方式，就是在一个函数内部创建另一个函数。

* **当函数可以记住并访问所在的词法作用域时，就产生了==闭包==，即使函数是在当前词法作用域之外执行。** 【你不知道的JavaScript上】

> 我们在词法作用域的环境下写代码，而其中的函数也是值，可以随意传来传去。

* **函数对象可以通过作用域链相互关联起来，函数体内部的变量都可以保存在函数作用域内，这种特性在计算机科学文献中称为“==闭包==”**。 【JavaScript权威指南】

> 从技术角度讲，所有的JavaScript函数都是闭包：它们都是对象，它们都关联到作用域链。

* 在计算机科学中，闭包（Closure）是词法闭包（Lexical Closure）的简称，是引用了自由变量的函数。这个被引用的自由变量将和这个函数一同存在，即使已经离开了创造它的环境也不例外。所以，有另一种说法认为闭包是由函数和与其相关的引用环境组合而成的实体。【维基百科】

>
Peter J. Landin 在1964年将术语闭包定义为一种包含环境成分和控制成分的实体。

闭包就是能够读取其他函数内部变量的函数。
由于在JavaScript语言中，只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成"定义在一个函数内部的函数"。
所以，在本质上，闭包就是将函数内部和函数外部连接起来的一座桥梁。

个人理解：**闭包其实就是一个函数，只是函数的存在方式比较特殊**；一般都是作为子函数被包含在另外一个函数内（暂且称为父函数），同时**作为父函数的返回值返回**。

#### 变量的作用域
JavaScript 闭包的本质源自两点，词法作用域和函数当作值传递。闭包是词法作用域的体现。一个持有外部环境变量的函数就是闭包。 

变量的作用域有两种：**全局变量和局部变量**

在函数定义之外**声明**的变量是**全局变量**，它的值可在整个程序中访问和修改。在函数定义内**声明**的变量是**局部变量**。每当执行函数时，都会创建和销毁该变量，且无法通过函数之外的任何代码访问该变量。


## 闭包的作用/应用场景

它的最大用处有两个，一个是**可以读取函数内部的变量**，另一个就是**让这些变量的值始终保持在内存中**。

1. setTimeout/setInterval
	.	 回调函数（callback）
	.	 事件句柄（event handle）

##   闭包的缺点

* 由于闭包会使得函数中的变量都被保存在内存中，**内存消耗很大**，所以不能滥用闭包，否则会造成网页的**性能问题**，在IE中可能导致**内存泄露**。解决方法是，在退出函数之前，将不使用的局部变量全部删除。
* **闭包会在父函数外部，改变父函数内部变量的值。**所以，如果你把父函数当作对象（object）使用，把闭包当作它的公用方法（Public Method），把内部变量当作它的私有属性（private value），这时一定要小心，不要随便改变父函数内部变量的值。

## 参考资料

* 【JavaScript权威指南（6rd）】
* 【JavaScript高级程序设计（3rd）】
* 【你不知道的JavaScript上】
* [学习Javascript闭包（Closure）](http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html) 
* [闭包-维基百科](https://zh.wikipedia.org/wiki/%E9%97%AD%E5%8C%85_(%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6))
* [全面理解Javascript闭包和闭包的几种写法及用途](https://www.cnblogs.com/yunfeifei/p/4019504.html)


